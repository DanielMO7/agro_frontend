<div class="h-full flex flex-col relative p-4" [@fadeIn]>
  <div class="flex flex-col sm:items-center sm:justify-center">
    <div class="w-full text-center mb-6">
      <h1 class="text-4xl font-bold text-gray-800 uppercase">Inventario</h1>
    </div>

    <div class="w-full flex justify-center mb-6">
      <div class="relative w-full sm:w-1/2">
        <input type="text" placeholder="Buscar por insumo, almacén o usuario..." [(ngModel)]="searchTerm"
          class="w-full pr-10 pl-4 py-2 border border-gray-300 rounded-full shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500" />
        <span
          class="material-icons absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none">
          search
        </span>
      </div>
    </div>
  </div>

  <div *ngIf="loading()" class="text-center text-gray-600 py-4">
    Cargando inventario...
  </div>

  <div *ngIf="error()" class="text-center text-red-500 py-4">
    {{ error() }}
  </div>

  <div *ngIf="!loading() && !error() && filteredInventory().length === 0" class="text-center text-gray-500 py-4">
    No hay registros de inventario.
  </div>

  <div *ngIf="!loading() && filteredInventory().length > 0" class="overflow-y-auto max-h-[65vh] p-2">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      <div *ngFor="let inventoryItem of filteredInventory()"
        class="cursor-pointer group bg-white rounded-2xl shadow-md p-5 hover:shadow-xl transition-all border border-gray-200 flex gap-4 items-start hover:ring-2 hover:ring-green-600"
        (click)="goToInventory(inventoryItem.id)">

        <!-- Icono de insumo -->
        <div class="w-16 h-16 rounded-lg bg-green-50 flex items-center justify-center text-green-600 border">
          <span class="material-icons text-3xl">inventory_2</span>
        </div>

        <!-- Contenido -->
        <div class="flex-1">
          <div class="flex justify-between items-start mb-1">
            <h2 class="text-base font-semibold text-gray-800">
              {{ inventoryItem.input?.name || 'Insumo desconocido' }}
            </h2>
            <span class="text-sm font-bold text-gray-500">#{{ inventoryItem.id }}</span>
          </div>

          <div class="text-sm text-gray-700 mb-1">
            <span class="inline-flex items-center gap-1">
              <span class="material-icons text-base text-gray-500">store</span>
              {{ inventoryItem.warehouse?.name || 'Sin almacén' }}
            </span>
          </div>

          <div class="text-sm text-gray-700 mb-1">
            <span class="inline-flex items-center gap-1">
              <span class="material-icons text-base text-gray-500">person</span>
              {{ inventoryItem.user?.name || 'Sin usuario' }}
            </span>
          </div>

          <div class="text-sm text-gray-700">
            <span class="inline-flex items-center gap-1">
              <span class="material-icons text-base text-gray-500">swap_vert</span>
              {{ inventoryItem.is_input ? 'Ingreso' : 'Egreso' }}:
              <span class="font-bold">{{ inventoryItem.amount }}</span> unidades
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Botón flotante para agregar -->
<button (click)="goToAddInventory()"
  class="fixed bottom-14 left-1/2 transform -translate-x-1/2
         bg-green-600 hover:bg-green-700 text-white rounded-full
         w-14 h-14 text-3xl
         sm:w-20 sm:h-20 sm:text-2xl
         shadow-lg flex items-center justify-center
         transition duration-200 z-50"
  aria-label="Agregar inventario">
  <span class="material-icons text-white text-[28px] sm:text-[36px]">add</span>
</button>
